<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Documentation - Gesti√≥n de Usuarios y Productos</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
            color: #333;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        .endpoint {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            font-size: 12px;
            margin-right: 10px;
        }
        .get { background: #28a745; }
        .post { background: #007bff; }
        .put { background: #ffc107; color: #212529; }
        .delete { background: #dc3545; }
        .patch { background: #6f42c1; }
        
        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        
        pre {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            overflow-x: auto;
        }
        
        .example {
            background: #e7f3ff;
            border: 1px solid #bee5eb;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        th, td {
            border: 1px solid #dee2e6;
            padding: 8px 12px;
            text-align: left;
        }
        
        th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .toc {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 0;
        }
        
        .toc li {
            margin: 5px 0;
        }
        
        .toc a {
            text-decoration: none;
            color: #007bff;
        }
        
        .toc a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <h1>üöÄ API de Gesti√≥n de Usuarios y Productos</h1>
    
    <div class="success">
        <strong>üìã Proyecto Actividad 3 - APIs Implementadas</strong><br>
        Este proyecto implementa dos APIs completas seg√∫n los requisitos especificados:
        <ul>
            <li>‚úÖ <strong>API de Gesti√≥n de Usuarios</strong> con operaciones CRUD y estad√≠sticas</li>
            <li>‚úÖ <strong>API de Gesti√≥n de Productos</strong> con valoraciones y comentarios</li>
            <li>‚úÖ <strong>Autenticaci√≥n con tokens</strong> que expiran cada 5 minutos</li>
            <li>‚úÖ <strong>Estad√≠sticas de usuarios</strong> por d√≠a, semana y mes</li>
            <li>‚úÖ <strong>Sistema de valoraciones y comentarios</strong> para productos</li>
        </ul>
    </div>

    <div class="toc">
        <h2>üìñ Tabla de Contenidos</h2>
        <ul>
            <li><a href="#base-url">üåê URL Base</a></li>
            <li><a href="#auth">üîê Autenticaci√≥n</a></li>
            <li><a href="#users-api">üë• API de Gesti√≥n de Usuarios</a></li>
            <li><a href="#products-api">üì¶ API de Gesti√≥n de Productos</a></li>
            <li><a href="#examples">üí° Ejemplos de Uso</a></li>
            <li><a href="#testing">üß™ Endpoints de Testing</a></li>
        </ul>
    </div>

    <h2 id="base-url">üåê URL Base</h2>
    <div class="example">
        <strong>Desarrollo Local:</strong> <code>http://localhost:8000/api</code><br>
        <strong>Laravel Herd:</strong> <code>http://api-development.test/api</code>
    </div>

    <h2 id="auth">üîê Autenticaci√≥n</h2>
    
    <div class="warning">
        <strong>‚ö†Ô∏è Importante:</strong> Los tokens de acceso expiran cada <strong>5 minutos</strong>. 
        Usa el endpoint <code>/api/auth/refresh</code> para renovar tu token antes de que expire.
    </div>

    <div class="endpoint">
        <span class="method post">POST</span>
        <strong>/api/auth/register</strong> - Registro de usuario
        <pre>{
  "name": "Juan P√©rez",
  "email": "juan@example.com",
  "password": "password123",
  "password_confirmation": "password123",
  "phone": "+1234567890",
  "birth_date": "1990-05-15",
  "gender": "male",
  "bio": "Desarrollador apasionado",
  "avatar": "https://via.placeholder.com/150"
}</pre>
    </div>

    <div class="endpoint">
        <span class="method post">POST</span>
        <strong>/api/auth/login</strong> - Inicio de sesi√≥n
        <pre>{
  "email": "juan@example.com",
  "password": "password123"
}</pre>
    </div>

    <div class="endpoint">
        <span class="method post">POST</span>
        <strong>/api/auth/refresh</strong> - Renovar token
        <br><small>Requiere: Authorization Bearer Token</small>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/auth/me</strong> - Informaci√≥n del usuario autenticado
        <br><small>Requiere: Authorization Bearer Token</small>
    </div>

    <h2 id="users-api">üë• API de Gesti√≥n de Usuarios</h2>

    <h3>üî® Operaciones CRUD</h3>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/users</strong> - Listar usuarios
        <br><small>Par√°metros: ?per_page=10</small>
    </div>

    <div class="endpoint">
        <span class="method post">POST</span>
        <strong>/api/users</strong> - Crear usuario
        <pre>{
  "name": "Mar√≠a Garc√≠a",
  "email": "maria@example.com",
  "password": "password123",
  "phone": "+0987654321",
  "birth_date": "1985-08-22",
  "gender": "female",
  "bio": "Dise√±adora UX/UI",
  "is_active": true
}</pre>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/users/{id}</strong> - Ver usuario espec√≠fico
    </div>

    <div class="endpoint">
        <span class="method put">PUT</span>
        <strong>/api/users/{id}</strong> - Actualizar usuario
    </div>

    <div class="endpoint">
        <span class="method delete">DELETE</span>
        <strong>/api/users/{id}</strong> - Eliminar usuario
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/users/search</strong> - Buscar usuarios
        <br><small>Par√°metros: ?q=nombre_o_email</small>
    </div>

    <h3>üìä Estad√≠sticas de Usuarios</h3>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/users/stats</strong> - Estad√≠sticas generales
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/users/stats/daily</strong> - Registros por d√≠a
        <br><small>Par√°metros: ?days=30 (√∫ltimos 30 d√≠as)</small>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/users/stats/weekly</strong> - Registros por semana
        <br><small>Par√°metros: ?weeks=12 (√∫ltimas 12 semanas)</small>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/users/stats/monthly</strong> - Registros por mes
        <br><small>Par√°metros: ?months=12 (√∫ltimos 12 meses)</small>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/users/stats/demographics</strong> - Estad√≠sticas demogr√°ficas
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/users/stats/most-active</strong> - Usuarios m√°s activos
        <br><small>Par√°metros: ?limit=10</small>
    </div>

    <h2 id="products-api">üì¶ API de Gesti√≥n de Productos</h2>

    <h3>üî® Operaciones CRUD</h3>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/products</strong> - Listar productos
        <br><small>Par√°metros: ?per_page=10&category=Electr√≥nicos&sort_by=rating&sort_order=desc</small>
    </div>

    <div class="endpoint">
        <span class="method post">POST</span>
        <strong>/api/products</strong> - Crear producto
        <pre>{
  "name": "iPhone 15 Pro",
  "description": "El iPhone m√°s avanzado con chip A17 Pro",
  "price": 999.99,
  "category": "Electr√≥nicos",
  "brand": "Apple",
  "sku": "APPLE-IP15-PRO-001",
  "stock": 50,
  "images": ["https://via.placeholder.com/400x300"],
  "is_active": true
}</pre>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/products/{id}</strong> - Ver producto espec√≠fico
    </div>

    <div class="endpoint">
        <span class="method put">PUT</span>
        <strong>/api/products/{id}</strong> - Actualizar producto
        <br><small>Solo el propietario puede actualizar</small>
    </div>

    <div class="endpoint">
        <span class="method delete">DELETE</span>
        <strong>/api/products/{id}</strong> - Eliminar producto
        <br><small>Solo el propietario puede eliminar</small>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/products/search</strong> - Buscar productos
        <br><small>Par√°metros: ?q=nombre_marca_categoria</small>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/products/top-rated</strong> - Productos mejor valorados
        <br><small>Par√°metros: ?limit=10</small>
    </div>

    <h3>‚≠ê Sistema de Valoraciones</h3>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/ratings</strong> - Listar valoraciones
        <br><small>Par√°metros: ?product_id=1&per_page=10</small>
    </div>

    <div class="endpoint">
        <span class="method post">POST</span>
        <strong>/api/ratings</strong> - Crear valoraci√≥n
        <pre>{
  "product_id": 1,
  "rating": 5,
  "review": "Excelente producto, cumple con todas mis expectativas"
}</pre>
        <div class="warning">
            <strong>Restricciones:</strong>
            <ul>
                <li>No puedes valorar tu propio producto</li>
                <li>Solo una valoraci√≥n por usuario por producto</li>
                <li>Rating debe ser entre 1 y 5</li>
            </ul>
        </div>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/ratings/{id}</strong> - Ver valoraci√≥n espec√≠fica
    </div>

    <div class="endpoint">
        <span class="method put">PUT</span>
        <strong>/api/ratings/{id}</strong> - Actualizar valoraci√≥n
        <br><small>Solo el autor puede actualizar</small>
    </div>

    <div class="endpoint">
        <span class="method delete">DELETE</span>
        <strong>/api/ratings/{id}</strong> - Eliminar valoraci√≥n
        <br><small>Solo el autor puede eliminar</small>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/ratings/product/{productId}/stats</strong> - Estad√≠sticas de valoraciones
    </div>

    <h3>üí¨ Sistema de Comentarios</h3>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/comments</strong> - Listar comentarios
        <br><small>Par√°metros: ?product_id=1&approved=true&per_page=10</small>
    </div>

    <div class="endpoint">
        <span class="method post">POST</span>
        <strong>/api/comments</strong> - Crear comentario
        <pre>{
  "product_id": 1,
  "comment": "¬øViene con garant√≠a extendida?"
}</pre>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/comments/{id}</strong> - Ver comentario espec√≠fico
    </div>

    <div class="endpoint">
        <span class="method put">PUT</span>
        <strong>/api/comments/{id}</strong> - Actualizar comentario
        <br><small>Solo el autor puede actualizar</small>
    </div>

    <div class="endpoint">
        <span class="method delete">DELETE</span>
        <strong>/api/comments/{id}</strong> - Eliminar comentario
        <br><small>El autor o propietario del producto pueden eliminar</small>
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/comments/my-products</strong> - Comentarios de mis productos
    </div>

    <div class="endpoint">
        <span class="method patch">PATCH</span>
        <strong>/api/comments/{id}/toggle-approval</strong> - Aprobar/desaprobar comentario
        <br><small>Solo el propietario del producto</small>
    </div>

    <h2 id="examples">üí° Ejemplos de Uso Completos</h2>

    <h3>üöÄ Flujo Completo: Usuario y Producto</h3>

    <div class="example">
        <h4>1. Registrar un nuevo usuario</h4>
        <strong>POST</strong> <code>/api/auth/register</code>
        <pre>curl -X POST http://localhost:8000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Carlos Desarrollador",
    "email": "carlos@example.com",
    "password": "password123",
    "password_confirmation": "password123",
    "phone": "+1234567890",
    "birth_date": "1992-12-03",
    "gender": "male",
    "bio": "Desarrollador Full Stack"
  }'</pre>
    </div>

    <div class="example">
        <h4>2. Crear un producto (requiere token del paso 1)</h4>
        <strong>POST</strong> <code>/api/products</code>
        <pre>curl -X POST http://localhost:8000/api/products \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_TOKEN_HERE" \
  -d '{
    "name": "Laptop Gaming RGB",
    "description": "Laptop de alto rendimiento para gaming con iluminaci√≥n RGB",
    "price": 1299.99,
    "category": "Computadoras",
    "brand": "ASUS",
    "sku": "ASUS-ROG-GAMING-001",
    "stock": 15,
    "images": ["https://via.placeholder.com/400x300"]
  }'</pre>
    </div>

    <div class="example">
        <h4>3. Otro usuario valora el producto</h4>
        <strong>POST</strong> <code>/api/ratings</code>
        <pre>curl -X POST http://localhost:8000/api/ratings \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ANOTHER_USER_TOKEN" \
  -d '{
    "product_id": 1,
    "rating": 5,
    "review": "Incre√≠ble rendimiento para gaming, muy recomendado!"
  }'</pre>
    </div>

    <div class="example">
        <h4>4. Ver estad√≠sticas de usuarios registrados por mes</h4>
        <strong>GET</strong> <code>/api/users/stats/monthly</code>
        <pre>curl -X GET http://localhost:8000/api/users/stats/monthly?months=6 \
  -H "Authorization: Bearer YOUR_TOKEN_HERE"</pre>
    </div>

    <h2 id="testing">üß™ Endpoints de Testing (Sin Autenticaci√≥n)</h2>

    <div class="success">
        <strong>üéØ Para facilitar las pruebas</strong>, hemos incluido endpoints p√∫blicos que no requieren autenticaci√≥n:
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/test/info</strong> - Informaci√≥n completa de la API
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/test/products</strong> - Ver todos los productos
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/test/products/{id}</strong> - Ver producto espec√≠fico
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/test/ratings</strong> - Ver todas las valoraciones
    </div>

    <div class="endpoint">
        <span class="method get">GET</span>
        <strong>/api/test/comments</strong> - Ver todos los comentarios
    </div>

    <h2>üë®‚Äçüíª Usuarios de Prueba Disponibles</h2>
    
    <table>
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Email</th>
                <th>Password</th>
                <th>Rol</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Juan P√©rez</td>
                <td>juan@example.com</td>
                <td>password123</td>
                <td>Usuario regular</td>
            </tr>
            <tr>
                <td>Mar√≠a Garc√≠a</td>
                <td>maria@example.com</td>
                <td>password123</td>
                <td>Usuario regular</td>
            </tr>
            <tr>
                <td>Carlos Rodr√≠guez</td>
                <td>carlos@example.com</td>
                <td>password123</td>
                <td>Usuario regular</td>
            </tr>
            <tr>
                <td>Demo User</td>
                <td>demo@example.com</td>
                <td>demo123</td>
                <td>Usuario de demostraci√≥n</td>
            </tr>
        </tbody>
    </table>

    <div class="warning">
        <h3>‚ö†Ô∏è Notas Importantes</h3>
        <ul>
            <li><strong>Tokens de expiraci√≥n:</strong> Los tokens expiran cada 5 minutos seg√∫n los requisitos</li>
            <li><strong>Validaciones de seguridad:</strong> No puedes valorar tus propios productos</li>
            <li><strong>Restricciones de propiedad:</strong> Solo puedes modificar/eliminar tus propios productos, valoraciones y comentarios</li>
            <li><strong>Base de datos:</strong> Incluye datos de prueba con 55+ usuarios, 8 productos, m√∫ltiples valoraciones y comentarios</li>
            <li><strong>Estad√≠sticas:</strong> Los datos est√°n distribuidos en los √∫ltimos 6 meses para generar estad√≠sticas realistas</li>
        </ul>
    </div>

    <div class="success">
        <h3>‚úÖ Caracter√≠sticas Implementadas</h3>
        <ul>
            <li>‚úÖ <strong>CRUD completo para usuarios</strong> con validaciones</li>
            <li>‚úÖ <strong>CRUD completo para productos</strong> con autorizaci√≥n</li>
            <li>‚úÖ <strong>Sistema de autenticaci√≥n</strong> con tokens de 5 minutos</li>
            <li>‚úÖ <strong>Estad√≠sticas de usuarios</strong> por d√≠a, semana y mes</li>
            <li>‚úÖ <strong>Sistema de valoraciones</strong> con restricciones de seguridad</li>
            <li>‚úÖ <strong>Sistema de comentarios</strong> con aprobaci√≥n</li>
            <li>‚úÖ <strong>B√∫squeda y filtrado</strong> en usuarios y productos</li>
            <li>‚úÖ <strong>Productos mejor valorados</strong> con promedios calculados</li>
            <li>‚úÖ <strong>Endpoints de testing</strong> para facilitar las pruebas</li>
            <li>‚úÖ <strong>Documentaci√≥n completa</strong> con ejemplos de uso</li>
            <li>‚úÖ <strong>Base de datos poblada</strong> con datos de prueba realistas</li>
        </ul>
    </div>

    <footer style="margin-top: 50px; padding: 20px; background: #f8f9fa; border-radius: 4px; text-align: center;">
        <p><strong>üéì Proyecto Actividad 3 - Desarrollo de APIs</strong></p>
        <p>Implementaci√≥n completa de APIs de Gesti√≥n de Usuarios y Productos con Laravel</p>
    </footer>
</body>
</html>